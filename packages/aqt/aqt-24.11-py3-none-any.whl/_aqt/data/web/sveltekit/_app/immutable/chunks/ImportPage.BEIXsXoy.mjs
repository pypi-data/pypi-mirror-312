import{e as L,a as v,b as T,t as X}from"./disclose-version.C7Ref1zK.mjs";import{p as R,l as M,a as W,aM as q,b as A,N as b,P,O as m,t as C,L as E,g as t,m as N,s as x,ay as U,aY as pt,n as Y}from"./runtime.BreniANL.mjs";import{p as k,a as O}from"./props.CyhLJmEU.mjs";import{c as V,C as st}from"./Container.BA026blb.mjs";import{s as Q,v as ft,p as Z,w as gt}from"./backend.fkC9kjAd.mjs";import{I as ht,b as bt}from"./IconButton.CQVGe_K4.mjs";import{i as H}from"./lifecycle.CyW130Fa.mjs";import{s as F,e as at}from"./render.DcSgmNQ4.mjs";import{t as _t,b9 as yt,v as G,q as ot,ba as $t,bb as wt,bc as xt,bd as nt,be as J,bf as kt,bg as it,bh as lt,bi as St,bj as Tt,bk as It,bl as Nt,bm as Pt,bn as Ct,bo as Bt,bp as qt,bq as zt,br as Dt,bs as Et,bt as Ft,bu as Mt,bv as Ot}from"./runtime-require.DNOiO2i-.mjs";import{s as Rt,a as At}from"./store.BCoIkSvf.mjs";import{r as Ht}from"./progress.C0ky-jd_.mjs";import{p as Lt,e as dt,i as Ut}from"./theme.C2zODCPG.mjs";import{S as jt,g as Qt,n as Wt,l as Vt,u as Yt,q as Gt,I as ct,r as Jt,f as Kt}from"./Shortcut.DmvJtCcr.mjs";import{B as Xt}from"./ButtonToolbar.B1nFHt_L.mjs";import{S as Zt,L as te}from"./LabelButton.B49ZAgmI.mjs";import{R as tt}from"./Row.Bs46Alvy.mjs";import{T as et}from"./TitledContainer.CEgJrMj0.mjs";import{b as K}from"./this.CuBSVDza.mjs";import{W as ee}from"./WithTooltip.BJN9IUR6.mjs";import{c as re,o as se}from"./index-client.TjEV9IuS.mjs";var ae=T('<div class="progress svelte-z9dt5x"><div class="spinner svelte-z9dt5x"><div class="svelte-z9dt5x"></div> <div class="svelte-z9dt5x"></div> <div class="svelte-z9dt5x"></div> <div class="svelte-z9dt5x"></div></div> <div id="label" class="svelte-z9dt5x"> </div></div>');function oe(n,e){R(e,!1);const r=Rt(),a=()=>At(Lt,"$pageTheme",r);let o=k(e,"task",8),i=k(e,"result",12),p=k(e,"error",12),u=N("");function g(s){s.value.value&&s.value.case!=="none"&&t(u)!==s.value.value.toString()&&x(u,s.value.value.toString())}M(()=>(E(i()),E(p()),E(o())),()=>{(async()=>{if(!i()&&!p())try{i(await Ht(o(),g))}catch(s){if(s instanceof Error)p(s);else throw s}})()}),W(),H();var l=L(),$=q(l);O($,()=>!i(),s=>{var d=ae(),c=b(d),_=P(c,2),w=b(_);m(_),m(d),C(()=>{_t(c,"nightMode",a().isDark),F(w,t(u))}),v(s,d)}),v(n,l),A()}var ne=T('<div class="message svelte-1ebpei3"> </div>');function ie(n,e){R(e,!1);let r=k(e,"error",8);H();var a=ne(),o=b(a);m(a),C(()=>F(o,r().message)),v(n,a),A()}var le=T('<div class="import svelte-zco36t"> </div>'),de=T('<div class="filename svelte-zco36t"> </div> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper> <!>',1),ce=T('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function ue(n,e){R(e,!1);let r=k(e,"path",8),a=k(e,"onImport",8);const o="Control+Enter";function i(g){return g.split(/[\\/]/).pop()}H();var p=ce(),u=q(p);V(u,()=>({"--gutter-block":"0.5rem","--gutter-inline":"0.25rem","--sticky-borders":"0 0 1px"})),Zt(u.lastChild,{breakpoint:"sm",children:(g,l)=>{Xt(g,{class:"justify-content-between",wrap:!1,children:($,s)=>{var d=de(),c=q(d),_=b(c);C(()=>F(_,i(r()))),m(c);var w=P(c,2),z=U(()=>Qt(o));V(w,()=>({"--border-left-radius":"5px","--border-right-radius":"5px"})),te(w.lastChild,{primary:!0,get tooltip(){return t(z)},$$events:{click(...h){var S;(S=a())==null||S.apply(this,h)}},children:(h,S)=>{var B=le(),f=b(B);C(()=>F(f,yt())),m(B),v(h,B)},$$slots:{default:!0}}),m(w);var D=P(w,2);jt(D,{keyCombination:o,$$events:{action(...h){var S;(S=a())==null||S.apply(this,h)}}}),v($,d)},$$slots:{default:!0}})},$$slots:{default:!0}}),m(u),v(n,p),A()}var me=T("<tr><td></td></tr>"),ve=T("<tr><td></td></tr>"),pe=T('<div class="outer svelte-1c3gv3l"><table tabindex="-1"><thead><!></thead><tbody><!><!><!></tbody></table></div>');function fe(n,e){R(e,!1);const r=N(),a=N(),o=N(),i=N(),p=N();let u=k(e,"class",8,""),g=k(e,"itemsCount",8,0),l=k(e,"itemHeight",8),$=k(e,"bottomOffset",8,0),s=N(),d=N(0);window.addEventListener("resize",()=>{x(r,t(r))}),M(()=>(t(s),E($()),E(l())),()=>{x(r,t(s)?Math.floor((document.documentElement.clientHeight-t(s).offsetTop-$())/l())*l():0)}),M(()=>(t(r),E(l())),()=>{x(a,Math.ceil(t(r)/l()))}),M(()=>(t(d),E(l())),()=>{x(o,Math.floor(t(d)/l()))}),M(()=>(t(o),t(a),E(g())),()=>{x(i,Math.min(t(o)+t(a),g()))}),M(()=>(t(i),t(o)),()=>{x(p,new Array(t(i)-t(o)).fill(0).map((f,y)=>t(o)+y))}),W(),H();var c=pe();K(c,f=>x(s,f),()=>t(s));var _=b(c),w=b(_),z=b(w);Q(z,e,"headers",{}),m(w);var D=P(w),h=b(D);O(h,()=>l()*t(o)>0,f=>{var y=me(),I=b(y);m(y),C(()=>G(I,"style",`height: ${l()*t(o)}px;`)),v(f,y)});var S=P(h);dt(S,1,()=>t(p),f=>f,(f,y)=>{var I=L(),j=q(I);Q(j,e,"row",{get index(){return t(y)}}),v(f,I)});var B=P(S);O(B,()=>l()*g()-l()*t(i)>0,f=>{var y=ve(),I=b(y);m(y),C(()=>G(I,"style",`height: ${l()*g()-l()*t(i)}px;`)),v(f,y)}),m(D),m(_),m(c),C(()=>{var f,y;G(c,"style",`--container-height: ${(f=t(r))!=null?f:""}px`),ot(_,`table ${(y=u())!=null?y:""} svelte-1c3gv3l`)}),at("scroll",c,()=>x(d,t(s).scrollTop)),v(n,c),A()}function ge(n){let e,r;n.dupeResolution===Z.DUPLICATE?(e=Bt(),r=qt()):n.dupeResolution===Z.PRESERVE?(e=nt(),r=J()):(e=it(),r=lt());const a={reason:e,notes:n.firstFieldMatch};return{action:r,queue:a}}function he(n){const e=[{queues:[{notes:n.new,reason:$t()}],action:wt(),summaryTemplate:xt,canBrowse:!0,icon:Wt},{queues:[{notes:n.duplicate,reason:nt()}],action:J(),summaryTemplate:kt,canBrowse:!0,icon:Vt},{queues:[{notes:n.updated,reason:it()}],action:lt(),summaryTemplate:St,canBrowse:!0,icon:Yt},{queues:[{notes:n.conflicting,reason:Tt()},{notes:n.missingNotetype,reason:It()},{notes:n.missingDeck,reason:Nt()},{notes:n.emptyFirstField,reason:Pt()}],action:J(),summaryTemplate:Ct,canBrowse:!1,icon:Gt}],r=ge(n);for(const a of e)if(a.action===r.action){a.queues.push(r.queue);break}return e}function be(n){const e=[];for(const r of n)for(const a of r.queues)if(a.notes)for(const o of a.notes)e.push({summary:r,queue:a,note:o});return e}function ut(n){ft({filter:{case:"nids",value:{ids:n.map(e=>e.id.nid)}}})}var _e=T("<td><!></td>");function ye(n,e){R(e,!1);let r=k(e,"class",8,"");const a=re();let o=N();se(async()=>{a("mount",{element:t(o)})}),H();var i=_e();K(i,u=>x(o,u),()=>t(o));var p=b(i);Q(p,e,"default",{}),m(i),C(()=>ot(i,r())),v(n,i),A()}function rt(n,e){let r=k(e,"class",8,""),a=k(e,"tooltip",8);ee(n,{get tooltip(){return a()},children:pt,$$slots:{default:(o,i)=>{const p=U(()=>i.createTooltip);ye(o,{get class(){return r()},$$events:{mount:u=>t(p)(u.detail.element)},children:(u,g)=>{var l=L(),$=q(l);Q($,e,"default",{}),v(u,l)},$$slots:{default:!0}})}}})}var $e=T('<tr slot="headers" class="svelte-1blptr9"><th>#</th><th> </th><th> </th><th></th></tr>'),we=T('<tr class="svelte-1blptr9"><td class="index-cell svelte-1blptr9"> </td><!><!><td class="search-cell"><!></td></tr>'),xe=T("<div><!></div>");function ke(n,e){R(e,!1);const r=N();let a=k(e,"summaries",8),o=k(e,"bottomOffset",8,0),i=N();M(()=>E(a()),()=>{x(r,be(a()))}),W(),H();var p=xe();K(p,g=>x(i,g),()=>t(i));var u=b(p);O(u,()=>t(i),g=>{fe(g,{class:"details-table",itemHeight:40,get itemsCount(){return t(r).length},get bottomOffset(){return o()},$$slots:{headers:(l,$)=>{var s=$e(),d=P(b(s)),c=b(d);C(()=>F(c,zt())),m(d);var _=P(d),w=b(_);C(()=>F(w,Dt())),m(_),Y(),m(s),v(l,s)},row:(l,$)=>{const s=U(()=>$.index);var d=we(),c=b(d),_=b(c);m(c);var w=P(c);rt(w,{class:"status-cell",get tooltip(){return t(r)[t(s)].queue.reason},children:(f,y)=>{Y();var I=X();C(()=>F(I,t(r)[t(s)].summary.action)),v(f,I)},$$slots:{default:!0}});var z=P(w),D=U(()=>t(r)[t(s)].note.fields.join(","));rt(z,{class:"contents-cell",get tooltip(){return t(D)},children:(f,y)=>{Y();var I=X();C(()=>F(I,t(r)[t(s)].note.fields.join(","))),v(f,I)},$$slots:{default:!0}});var h=P(z),S=b(h),B=U(()=>!t(r)[t(s)].summary.canBrowse);ht(S,{class:"search-icon",iconSize:100,active:!1,get disabled(){return t(B)},$$events:{click:()=>{ut([t(r)[t(s)].note])}},children:(f,y)=>{ct(f,{icon:Jt})},$$slots:{default:!0}}),m(h),m(d),C(()=>F(_,t(s)+1)),v(l,d)}}})}),m(p),v(n,p),A()}var Se=T('<button class="desktop-only"> </button>'),Te=T('<li class="svelte-ohwq2k"><!> <!></li>');function Ie(n,e){R(e,!1);const r=N();let a=k(e,"summary",8);function o(u){ut(t(r)),u.preventDefault()}M(()=>E(a()),()=>{x(r,a().queues.map(u=>u.notes).flat())}),W(),H();var i=L(),p=q(i);O(p,()=>t(r).length,u=>{var g=Te(),l=b(g);Kt(l,{children:(d,c)=>{ct(d,{get icon(){return a().icon}})},$$slots:{default:!0}});var $=P(l);C(()=>{var d;return F($,` ${(d=a().summaryTemplate({count:t(r).length}))!=null?d:""} `)});var s=P($);O(s,()=>a().canBrowse,d=>{var c=Se(),_=b(c);C(()=>F(_,Et())),m(c),at("click",c,o),v(d,c)}),m(g),v(u,g)}),v(n,i),A()}var Ne=T("<p> </p> <ul></ul>",1),Pe=T("<!> <!>",1),Ce=T('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function Be(n,e){R(e,!1);const r=N(),a=N();let o=k(e,"response",8);const i=.5,p=getComputedStyle(document.documentElement),u=parseInt(p.fontSize),g=(3*i+.75)*u;M(()=>E(o()),()=>{x(r,he(o().log))}),M(()=>E(o()),()=>{var s,d;x(a,(d=(s=o().log)==null?void 0:s.foundNotes)!=null?d:0)}),W(),H();var l=Ce(),$=q(l);V($,()=>({"--gutter-inline":"0.25rem","--gutter-block":`${i}rem`})),st($.lastChild,{breakpoint:"sm",children:(s,d)=>{var c=Pe(),_=q(c);tt(_,{children:(z,D)=>{var h=U(()=>Mt());et(z,{get title(){return t(h)},children:(S,B)=>{var f=Ne(),y=q(f),I=b(y);C(()=>F(I,Ft({notes:t(a)}))),m(y);var j=P(y,2);dt(j,5,()=>t(r),Ut,(mt,vt)=>{Ie(mt,{get summary(){return t(vt)}})}),m(j),v(S,f)},$$slots:{default:!0}})},$$slots:{default:!0}});var w=P(_,2);tt(w,{children:(z,D)=>{var h=U(()=>Ot());et(z,{get title(){return t(h)},children:(S,B)=>{ke(S,{get summaries(){return t(r)},bottomOffset:g})},$$slots:{default:!0}})},$$slots:{default:!0}}),v(s,c)},$$slots:{default:!0}}),m($),v(n,l),A()}var qe=T('<div class="pre-import-page svelte-1rmka3z"><!> <svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>');function Ze(n,e){R(e,!1);let r=k(e,"path",8),a=k(e,"importer",8);const o=!1;let i=N(void 0),p=N(void 0),u=N(o);async function g(){const s=await a().doImport();return await gt({}),x(u,!1),s}H();var l=L(),$=q(l);return O($,()=>t(p),s=>{ie(s,{get error(){return t(p)}})},s=>{var d=L(),c=q(d);O(c,()=>t(i),_=>{Be(_,{get response(){return t(i)}})},_=>{var w=L(),z=q(w);O(z,()=>t(u),D=>{oe(D,{task:g,get result(){return t(i)},set result(h){x(i,h)},get error(){return t(p)},set error(h){x(p,h)},$$legacy:!0})},D=>{var h=qe(),S=b(h);ue(S,{get path(){return r()},onImport:()=>x(u,!0)});var B=P(S,2);V(B,()=>({"--gutter-inline":"0.25rem","--gutter-block":"0.5rem"})),st(B.lastChild,{breakpoint:"sm",class:"container-columns",children:(f,y)=>{var I=L(),j=q(I);Q(j,e,"default",{}),v(f,I)},$$slots:{default:!0}}),m(B),m(h),v(D,h)},!0),v(_,w)},!0),v(s,d)}),v(n,l),bt(e,"noOptions",o),A({noOptions:o})}export{Ze as I};
