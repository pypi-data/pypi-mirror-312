import{D as U,a as v,F as q,r as m,d as I,e as h,s as _,t as rt}from"./disclose-version.CXWUuFGG.mjs";import{p as R,l as M,a as W,b as H,N as F,t as P,g as t,m as N,s as S,a0 as j,ag as Y}from"./runtime.BJSnJeWl.mjs";import{p as T,i as O}from"./props.fkJSEmZ6.mjs";import{c as G,C as it}from"./Container.CxVXZ9-Q.mjs";import{s as Q,z as gt,v as at,d as tt,A as $t}from"./backend.AWOyeTAw.mjs";import{I as ht,b as _t}from"./IconButton.DVHuyWt4.mjs";import{i as L}from"./lifecycle.DW1_rEFA.mjs";import{s as E,e as lt}from"./render.CQvFnAiW.mjs";import{t as bt,b7 as yt,v as X,q as dt,b8 as xt,b9 as kt,ba as wt,bb as ut,bc as Z,bd as St,be as ct,bf as mt,bg as Tt,bh as It,bi as Nt,bj as Pt,bk as Ct,bl as zt,bm as Bt,bn as qt,bo as Dt,bp as Ft,bq as Et,br as Mt,bs as At,bt as Ot}from"./runtime-require.AM6bqlff.mjs";import{s as Rt,a as Ht}from"./store.CAPRemx4.mjs";import{r as Lt}from"./progress.C31K7zWr.mjs";import{p as Ut,e as vt,i as jt}from"./theme.swshwi0b.mjs";import{S as Qt,g as Wt,n as Vt,k as Gt,u as Jt,l as Kt,I as pt,q as Xt,e as Yt}from"./Shortcut.C_u0IeGk.mjs";import{B as Zt}from"./ButtonToolbar.PvBtxz55.mjs";import{S as te,L as ee}from"./LabelButton.B36pBGCM.mjs";import{R as st}from"./Row.QzSAT3Up.mjs";import{T as ot}from"./TitledContainer.DaKOttrm.mjs";import{b as et}from"./this.C9pg2j_S.mjs";import{W as re}from"./WithTooltip.CGKCwsR4.mjs";import{c as ae,o as se}from"./index-client.D9hOaSri.mjs";var oe=I('<div class="progress svelte-z9dt5x"><div class="spinner svelte-z9dt5x"><div class="svelte-z9dt5x"></div> <div class="svelte-z9dt5x"></div> <div class="svelte-z9dt5x"></div> <div class="svelte-z9dt5x"></div></div> <div id="label" class="svelte-z9dt5x"> </div></div>');function ne(n,e){R(e,!1);const r=Rt(),s=()=>Ht(Ut,"$pageTheme",r);let o=T(e,"task"),i=T(e,"result",4),p=T(e,"error",4),c=N("");function g(a){a.value.value&&a.value.case!=="none"&&t(c)!==a.value.value.toString()&&S(c,a.value.value.toString())}M(()=>(F(i()),F(p()),F(o())),()=>{(async()=>{if(!i()&&!p())try{i(await Lt(o(),g))}catch(a){if(a instanceof Error)p(a);else throw a}})()}),W(),L();var l=U(),k=q(l);O(k,()=>!i(),a=>{var u=oe(),d=h(u);m(d);var b=_(_(d,!0)),y=h(b);m(b),m(u),P(()=>{bt(d,"nightMode",s().isDark),E(y,t(c))}),v(a,u)}),v(n,l),H()}var ie=I('<div class="message svelte-1ebpei3"> </div>');function le(n,e){R(e,!1);let r=T(e,"error");L();var s=ie(),o=h(s);m(s),P(()=>E(o,r().message)),v(n,s),H()}var de=I('<div class="import svelte-zco36t"> </div>'),ue=I('<div class="filename svelte-zco36t"> </div> <div style="display: contents"><!></div> <!>',1),ce=I('<div style="display: contents"><!></div>',1);function me(n,e){R(e,!1);let r=T(e,"path"),s=T(e,"onImport");const o="Control+Enter";function i(g){return g.split(/[\\/]/).pop()}L();var p=ce(),c=q(p);G(c,()=>({"--gutter-block":"0.5rem","--gutter-inline":"0.25rem","--sticky-borders":"0 0 1px"})),te(c.lastChild,{breakpoint:"sm",children:(g,l)=>{Zt(g,{class:"justify-content-between",wrap:!1,children:(k,a)=>{var u=ue(),d=q(u),b=h(d);P(()=>E(b,i(r()))),m(d);var y=_(_(d,!0)),z=j(()=>Wt(o));G(y,()=>({"--border-left-radius":"5px","--border-right-radius":"5px"})),ee(y.lastChild,{primary:!0,get tooltip(){return t(z)},$$events:{click(...$){const w=s();return w==null?void 0:w.apply(this,$)}},children:($,w)=>{var B=de(),C=h(B);P(()=>E(C,yt())),m(B),v($,B)},$$slots:{default:!0},$$legacy:!0}),m(y);var D=_(_(y,!0));Qt(D,{keyCombination:o,$$events:{action(...$){const w=s();return w==null?void 0:w.apply(this,$)}},$$legacy:!0}),v(k,u)},$$slots:{default:!0},$$legacy:!0})},$$slots:{default:!0},$$legacy:!0}),m(c),v(n,p),H()}var ve=I("<tr><td></td></tr>"),pe=I("<tr><td></td></tr>"),fe=I('<div class="outer svelte-1c3gv3l"><table tabindex="-1"><thead><!></thead><tbody><!><!><!></tbody></table></div>');function ge(n,e){var C;R(e,!1);const r=N(),s=N(),o=N(),i=N(),p=N();let c=T(e,"class",0,""),g=T(e,"itemsCount",0,0),l=T(e,"itemHeight"),k=T(e,"bottomOffset",0,0),a=N(),u=N(0);window.addEventListener("resize",()=>{S(r,t(r))}),M(()=>(t(a),F(k()),F(l())),()=>{S(r,t(a)?Math.floor((document.documentElement.clientHeight-t(a).offsetTop-k())/l())*l():0)}),M(()=>(t(r),F(l())),()=>{S(s,Math.ceil(t(r)/l()))}),M(()=>(t(u),F(l())),()=>{S(o,Math.floor(t(u)/l()))}),M(()=>(t(o),t(s),F(g())),()=>{S(i,Math.min(t(o)+t(s),g()))}),M(()=>(t(i),t(o)),()=>{S(p,new Array(t(i)-t(o)).fill(0).map((x,f)=>t(o)+f))}),W(),L();var d=fe();et(d,x=>S(a,x),()=>t(a));var b=h(d),y=h(b),z=h(y);Q(z,(C=e.$$slots)==null?void 0:C.headers,{}),m(y);var D=_(y),$=h(D);O($,()=>l()*t(o)>0,x=>{var f=ve(),A=h(f);m(f),P(()=>X(A,"style",`height: ${l()*t(o)}px;`)),v(x,f)});var w=_($);vt(w,5,()=>t(p),(x,f)=>Y(x),(x,f,A)=>{var K;var V=U(),J=q(V);Q(J,(K=e.$$slots)==null?void 0:K.row,{get index(){return Y(f)}}),v(x,V)});var B=_(w);O(B,()=>l()*g()-l()*t(i)>0,x=>{var f=pe(),A=h(f);m(f),P(()=>X(A,"style",`height: ${l()*g()-l()*t(i)}px;`)),v(x,f)}),m(D),m(b),m(d),P(()=>{var x,f;X(d,"style",`--container-height: ${(x=t(r))!=null?x:""}px`),dt(b,`table ${(f=c())!=null?f:""} svelte-1c3gv3l`)}),lt("scroll",d,()=>S(u,t(a).scrollTop),!1),v(n,d),H()}function $e(n){let e,r;n.dupeResolution===at.DUPLICATE?(e=Bt(),r=qt()):n.dupeResolution===at.PRESERVE?(e=ut(),r=Z()):(e=ct(),r=mt());const s={reason:e,notes:n.firstFieldMatch};return{action:r,queue:s}}function he(n){const e=[{queues:[{notes:n.new,reason:xt()}],action:kt(),summaryTemplate:wt,canBrowse:!0,icon:Vt},{queues:[{notes:n.duplicate,reason:ut()}],action:Z(),summaryTemplate:St,canBrowse:!0,icon:Gt},{queues:[{notes:n.updated,reason:ct()}],action:mt(),summaryTemplate:Tt,canBrowse:!0,icon:Jt},{queues:[{notes:n.conflicting,reason:It()},{notes:n.missingNotetype,reason:Nt()},{notes:n.missingDeck,reason:Pt()},{notes:n.emptyFirstField,reason:Ct()}],action:Z(),summaryTemplate:zt,canBrowse:!1,icon:Kt}],r=$e(n);for(const s of e)if(s.action===r.action){s.queues.push(r.queue);break}return e}function _e(n){const e=[];for(const r of n)for(const s of r.queues)if(s.notes)for(const o of s.notes)e.push({summary:r,queue:s,note:o});return e}function ft(n){gt({filter:{case:"nids",value:{ids:n.map(e=>e.id.nid)}}})}var be=I("<td><!></td>");function ye(n,e){R(e,!1);let r=T(e,"class",0,"");const s=ae();let o=N();se(async()=>{s("mount",{element:t(o)})}),L();var i=be();et(i,c=>S(o,c),()=>t(o));var p=h(i);Q(p,tt(e),{}),m(i),P(()=>dt(i,r())),v(n,i),H()}function nt(n,e){let r=T(e,"class",0,""),s=T(e,"tooltip");re(n,{get tooltip(){return s()},children:(o,i)=>{const p=j(()=>i.createTooltip);ye(o,{get class(){return r()},$$events:{mount:c=>t(p)(c.detail.element)},children:(c,g)=>{var l=U(),k=q(l);Q(k,tt(e),{}),v(c,l)},$$slots:{default:!0},$$legacy:!0})},$$slots:{default:!0},$$legacy:!0})}var xe=I('<tr slot="headers" class="svelte-1blptr9"><th>#</th><th> </th><th> </th><th></th></tr>'),ke=I('<tr class="svelte-1blptr9"><td class="index-cell svelte-1blptr9"> </td><!><!><td class="search-cell"><!></td></tr>'),we=I("<div><!></div>");function Se(n,e){R(e,!1);const r=N();let s=T(e,"summaries"),o=T(e,"bottomOffset",0,0),i=N();M(()=>F(s()),()=>{S(r,_e(s()))}),W(),L();var p=we();et(p,g=>S(i,g),()=>t(i));var c=h(p);O(c,()=>t(i),g=>{ge(g,{class:"details-table",itemHeight:40,get itemsCount(){return t(r).length},get bottomOffset(){return o()},$$slots:{headers:(l,k)=>{var a=xe(),u=h(a),d=_(u),b=h(d);P(()=>E(b,Dt())),m(d);var y=_(d),z=h(y);P(()=>E(z,Ft())),m(y),m(a),v(l,a)},row:(l,k)=>{const a=j(()=>k.index);var u=ke(),d=h(u),b=h(d);m(d);var y=_(d);nt(y,{class:"status-cell",get tooltip(){return t(r)[t(a)].queue.reason},children:(C,x)=>{var f=rt();P(()=>E(f,t(r)[t(a)].summary.action)),v(C,f)},$$slots:{default:!0},$$legacy:!0});var z=_(y),D=j(()=>t(r)[t(a)].note.fields.join(","));nt(z,{class:"contents-cell",get tooltip(){return t(D)},children:(C,x)=>{var f=rt();P(()=>E(f,t(r)[t(a)].note.fields.join(","))),v(C,f)},$$slots:{default:!0},$$legacy:!0});var $=_(z),w=h($),B=j(()=>!t(r)[t(a)].summary.canBrowse);ht(w,{class:"search-icon",iconSize:100,active:!1,get disabled(){return t(B)},$$events:{click:()=>{ft([t(r)[t(a)].note])}},children:(C,x)=>{pt(C,{icon:Xt,$$legacy:!0})},$$slots:{default:!0},$$legacy:!0}),m($),m(u),P(()=>E(b,t(a)+1)),v(l,u)}},$$legacy:!0})}),m(p),v(n,p),H()}var Te=I('<button class="desktop-only"> </button>'),Ie=I('<li class="svelte-ohwq2k"><!> <!></li>');function Ne(n,e){R(e,!1);const r=N();let s=T(e,"summary");function o(c){ft(t(r)),c.preventDefault()}M(()=>F(s()),()=>{S(r,s().queues.map(c=>c.notes).flat())}),W(),L();var i=U(),p=q(i);O(p,()=>t(r).length,c=>{var g=Ie(),l=h(g);Yt(l,{children:(u,d)=>{pt(u,{get icon(){return s().icon},$$legacy:!0})},$$slots:{default:!0},$$legacy:!0});var k=_(l,!0);P(()=>{var u;return E(k,` ${(u=s().summaryTemplate({count:t(r).length}))!=null?u:""} `)});var a=_(k);O(a,()=>s().canBrowse,u=>{var d=Te(),b=h(d);P(()=>E(b,Et())),m(d),lt("click",d,o,!1),v(u,d)}),m(g),v(c,g)}),v(n,i),H()}var Pe=I("<p> </p> <ul></ul>",1),Ce=I("<!> <!>",1),ze=I('<div style="display: contents"><!></div>',1);function Be(n,e){R(e,!1);const r=N(),s=N();let o=T(e,"response");const i=.5,p=getComputedStyle(document.documentElement),c=parseInt(p.fontSize),g=(3*i+.75)*c;M(()=>F(o()),()=>{S(r,he(o().log))}),M(()=>F(o()),()=>{var a,u;S(s,(u=(a=o().log)==null?void 0:a.foundNotes)!=null?u:0)}),W(),L();var l=ze(),k=q(l);G(k,()=>({"--gutter-inline":"0.25rem","--gutter-block":`${i}rem`})),it(k.lastChild,{breakpoint:"sm",children:(a,u)=>{var d=Ce(),b=q(d);st(b,{children:(z,D)=>{var $=j(()=>At());ot(z,{get title(){return t($)},children:(w,B)=>{var C=Pe(),x=q(C),f=h(x);P(()=>E(f,Mt({notes:t(s)}))),m(x);var A=_(_(x,!0));vt(A,9,()=>t(r),jt,(V,J,K)=>{Ne(V,{get summary(){return Y(J)},$$legacy:!0})}),m(A),v(w,C)},$$slots:{default:!0},$$legacy:!0})},$$slots:{default:!0},$$legacy:!0});var y=_(_(b,!0));st(y,{children:(z,D)=>{var $=j(()=>Ot());ot(z,{get title(){return t($)},children:(w,B)=>{Se(w,{get summaries(){return t(r)},bottomOffset:g,$$legacy:!0})},$$slots:{default:!0},$$legacy:!0})},$$slots:{default:!0},$$legacy:!0}),v(a,d)},$$slots:{default:!0},$$legacy:!0}),m(k),v(n,l),H()}var qe=I('<div class="pre-import-page svelte-1rmka3z"><!> <div style="display: contents"><!></div></div>');function tr(n,e){R(e,!1);let r=T(e,"path"),s=T(e,"importer");const o=!1;let i=N(void 0),p=N(void 0),c=N(o);async function g(){const a=await s().doImport();return await $t({}),S(c,!1),a}L();var l=U(),k=q(l);return O(k,()=>t(p),a=>{le(a,{get error(){return t(p)},$$legacy:!0})},a=>{var u=U(),d=q(u);O(d,()=>t(i),b=>{Be(b,{get response(){return t(i)},$$legacy:!0})},b=>{var y=U(),z=q(y);O(z,()=>t(c),D=>{ne(D,{task:g,get result(){return t(i)},set result($){S(i,$)},get error(){return t(p)},set error($){S(p,$)},$$legacy:!0})},D=>{var $=qe(),w=h($);me(w,{get path(){return r()},onImport:()=>S(c,!0),$$legacy:!0});var B=_(_(w,!0));G(B,()=>({"--gutter-inline":"0.25rem","--gutter-block":"0.5rem"})),it(B.lastChild,{breakpoint:"sm",class:"container-columns",children:(C,x)=>{var f=U(),A=q(f);Q(A,tt(e),{}),v(C,f)},$$slots:{default:!0},$$legacy:!0}),m(B),m($),v(D,$)},!0),v(b,y)},!0),v(a,u)}),v(n,l),_t(e,"noOptions",o),H({noOptions:o})}export{tr as I};
