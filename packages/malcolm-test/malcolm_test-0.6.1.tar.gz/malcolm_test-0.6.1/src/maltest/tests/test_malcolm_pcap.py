import mmguero

UPLOAD_ARTIFACTS = [
    'CTF/malcolm-micro-ctf.pcap',
    'Cyberville/Cyberville.pcap',
    'Plugins/2015-04-09-Nuclear-EK-traffic.pcap',
    'Plugins/2021-12-11-thru-13-server-activity-with-log4j-attempts.pcap',
    'Plugins/6in4-linklocal-hlimit-less255.pcap',
    'Plugins/apache_exploit_success.pcap',
    'Plugins/broken.pcap',
    'Plugins/chrome-34-google.trace',
    'Plugins/CVE-2020-1472_exploit_win2016.pcap',
    'Plugins/CVE-2020-1472_exploit_win2019.pcap',
    'Plugins/CVE-2020-1472_test_win2016.pcap',
    'Plugins/CVE-2020-1472_test_win2019.pcap',
    'Plugins/CVE-2021-38647-exploit-craigmunsw-omigod-lab.pcap',
    'Plugins/cve-2022-26809-4.pcap',
    'Plugins/doublepulsar-backdoor-connect-win7.pcap',
    'Plugins/download_over_dns.pcap',
    'Plugins/ecdsa-cert.pcap',
    'Plugins/esteemedaudit-failed-XPSP2.pcap',
    'Plugins/eternalblue-failed-patched-win7.pcap',
    'Plugins/eternalblue-success-unpatched-win7.pcap',
    'Plugins/eternalchampion.pcap',
    'Plugins/eternalromance-doublepulsar-meterpreter.pcap',
    'Plugins/eternalromance-success-2008r2.pcap',
    'Plugins/explicit.pcap',
    'Plugins/exploit.pcap',
    'Plugins/favicon.pcap',
    'Plugins/gnutls-tls1.2-non-vulnerable.pcap',
    'Plugins/gnutls-tls1.2-vulnerable.pcap',
    'Plugins/gnutls-tls1.3.pcap',
    'Plugins/http-etag-and-filename.pcap',
    'Plugins/http-filename-and-etag.pcap',
    'Plugins/http-filename.pcap',
    'Plugins/http_post.trace',
    'Plugins/http.trace',
    'Plugins/ipv6-neighbor-discovery.pcap',
    'Plugins/ipv6-router-advertisement-leaving.pcap',
    'Plugins/log4j-attack.pcap',
    'Plugins/log4j-dns_exfil.pcap',
    'Plugins/log4j-user_agent.pcap',
    'Plugins/log4j-webapp.pcap',
    'Plugins/metasploit-ms017-010-win7x64.pcap',
    'Plugins/pi3_poc.pcap',
    'Plugins/quasarrat.pcap',
    'Plugins/RS-RA.pcap',
    'Plugins/sample_OpenSSLv3.0.5.pcap',
    'Plugins/smb_mimikatz_copy_to_host.pcap',
    'Plugins/spcap-CEXKLs3NQWdEM2CoMj-1639421287179170294-1.pcap',
    'Plugins/spookyssl-merged.pcap',
    'Plugins/wannacry.pcap',
    'Protocols/BACnet.pcap',
    'Protocols/BSAP.pcap',
    'Protocols/DCERPC.pcap',
    'Protocols/DHCP.pcap',
    'Protocols/DNP3.pcap',
    'Protocols/DNS.pcap',
    'Protocols/ENIP.pcap',
    'Protocols/ETHERCAT.pcap',
    'Protocols/FTP.pcap',
    'Protocols/GENISYS.pcap',
    'Protocols/HTTP_1.pcap',
    'Protocols/HTTP_2.pcap',
    'Protocols/IPsec.pcap',
    'Protocols/IRC.pcap',
    'Protocols/KRB5.pcap',
    'Protocols/LDAP.pcap',
    'Protocols/Modbus.pcap',
    'Protocols/MQTT.pcap',
    'Protocols/MySQL.pcap',
    'Protocols/NTLM.pcap',
    'Protocols/NTP.pcap',
    'Protocols/OPCUA-Binary.pcap',
    'Protocols/OpenVPN.pcap',
    'Protocols/OSPF.pcap',
    'Protocols/PROFINET.pcap',
    'Protocols/QUIC.pcap',
    'Protocols/RADIUS.pcap',
    'Protocols/RDP.pcap',
    'Protocols/RFB.pcap',
    'Protocols/S7comm.pcap',
    'Protocols/SIP.pcap',
    'Protocols/SMB.pcap',
    'Protocols/SMTP.pcap',
    'Protocols/SNMP.pcap',
    'Protocols/SSH.pcap',
    'Protocols/SSL.pcap',
    'Protocols/STUN.pcap',
    'Protocols/Synchrophasor.pcap',
    'Protocols/Syslog.pcap',
    'Protocols/TDS.pcap',
    'Protocols/Telnet.pcap',
    'Protocols/TFTP.pcap',
    'Protocols/Tunnels.pcap',
    'Protocols/WireGuard.pcap',
]


def test_malcolm_pcap_hash(
    pcap_hash_map,
):
    assert all([pcap_hash_map.get(x, None) for x in mmguero.GetIterable(UPLOAD_ARTIFACTS)])
